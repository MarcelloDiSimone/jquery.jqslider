/*!
 * jQswipe v@VERSION - Swipe event for jQuery.
 * http://github.com/dinoboff/jQswipe/
 *
 * Copyright (c) 2009 Damien Lebrun
 * licenced under BSD
 * http://github.com/dinoboff/jQswipe/blob/master/LICENSE
 * 
 * Date: @DATE
 */
(function(){var a=this,b=a.jQuery,c=b.jQswipe={},d;b.each(["touches","targetTouches"],function(a,c){b.inArray(c,b.event.props)<0&&b.event.props.push(c)}),c.Swipe=function(a){b.extend(this,a)},d=c.Swipe.STATE={RUNNING:1,ENDED:2,CANCELLED:-1},c.Swipe.prototype={touches:[],type:"swipe",state:null,minLength:30,maxWidth:10,keepLast:2,reset:function(a){this.touches=[],this.state=d.RUNNING},push:function(a){var b;return a.length===1&&(b=a[0]),b&&b.pageX!==undefined&&b.pageY!==undefined?(this.touches.push({pageX:b.pageX,pageY:b.pageY}),this.compress(),this.size()-1):(this.cancel(),-1)},size:function(a){return this.touches.length},compress:function(){var a=this.size(),b;if(!this.keepLast||this.keepLast<1)return;b=a-this.keepLast-1,b>0&&this.touches.splice(1,b)},atIndex:function(a){var b=this.touches.length;if(b<1)return;return a=((Math.floor(Math.abs(a/b))+1)*b+a)%b,this.touches[a]},diff:function(a,b){var c=this.atIndex(a),d=this.atIndex(b);return{x:d.pageX-c.pageX,y:d.pageY-c.pageY}},validate:function(){var a=this.diff(0,-1),b=this.diff(-2,-1);return this.state===d.CANCELLED?!1:a.y>this.maxWidth||a.y<-this.maxWidth||b.x<0?(this.cancel(),!1):this.state===d.ENDED&&a.x<this.minLength?!1:!0},cancel:function(){this.state=d.CANCELLED},end:function(){this.state=d.ENDED}},c.SwipeSpecialEvent=function(a,c){var d=this;this.settings=c||{},this.settings.type=a||"swipe",this.setup=function(a,c){var e=b(this),f=d.prepareNamespaces(c),g=new b.jQswipe.Swipe(d.settings);b.each(["touchstart","touchmove","touchcancel","touchend"],function(a,b){f[0]=b,e.bind(f.join("."),g,d[b]),delete d[b].guid})},this.teardown=function(a){var c=b(this),e=d.prepareNamespaces(a);b.each(["touchstart","touchmove","touchcancel","touchend"],function(a,b){e[0]=b,c.unbind(e.join("."))})}},c.SwipeSpecialEvent.prototype={prepareNamespaces:function(a){var b=a.slice(0,a.length);return b.splice(0,0,"",this.settings.type),b},touchstart:function(a){var b=a.data;b.reset(),b.push(a.targetTouches||[])},touchmove:function(a){var b=a.data;b.validate()&&b.push(a.targetTouches||[])},touchcancel:function(a){var b=a.data;b.cancel()},touchend:function(a){var c=a.data;c.end(),c.validate()&&(a.type=c.type,b.event.handle.apply(this,arguments))}},c.register=function(a,c){b.event.special[a]=new b.jQswipe.SwipeSpecialEvent(a,c)},c.register("swipe"),c.register("rightSwipe"),c.register("leftSwipe",{validate:function(){var a=this.diff(0,-1),b=this.diff(-2,-1);return this.state===d.CANCELLED?!1:a.y>this.maxWidth||a.y<-this.maxWidth||b.x>0?(this.cancel(),!1):this.state===d.ENDED&&a.x>-this.minLength?!1:!0}}),b.fn.swipe=function(a){return b(this).bind("swipe",a)}})()